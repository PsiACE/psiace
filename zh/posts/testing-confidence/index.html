<!DOCTYPE html>

<html lang="zh">

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="color-scheme" content="light dark">
  
  
    
  
  <meta name="description" content="测试是维护者与用户之间的信任边界，核心是对预期的对齐而非覆盖率。">

  <title>聊聊测试自信</title>
  <link rel="icon" type="image/png" sizes="32x32" href="https://psiace.me/img/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="https://psiace.me/img/favicon-16x16.png">
  <link rel="apple-touch-icon" sizes="180x180" href="https://psiace.me/img/apple-touch-icon.png">
  
  <style>

  /* light mode colors */
  body {
    --primary-color: #5871a2;
    --primary-pale-color: #5871a233;
    --primary-decoration-color: #5871a210;
    --bg-color: #ffffff;
    --text-color: #2f3030;
    --text-pale-color: #767676;
    --text-decoration-color: #a9a9a9;
    --highlight-mark-color: #5f75b020;

    --callout-note-color: #5871a2;
    --callout-tip-color: #268556;
    --callout-important-color: #885fc9;
    --callout-warning-color: #ab6632;
    --callout-caution-color: #c64e4e;
  }

  /* dark mode colors */
  body.dark {
    --primary-color: #6f8fd1;
    --primary-pale-color: #6f8fd166;
    --primary-decoration-color: #6f8fd112;
    --bg-color: #1c1c1c;
    --text-color: #c1c1c1;
    --text-pale-color: #848484;
    --text-decoration-color: #5f5f5f;
    --highlight-mark-color: #8296cb3b;

    --callout-note-color: #6f8fd1;
    --callout-tip-color: #47976f;
    --callout-important-color: #9776cd;
    --callout-warning-color: #ad7a52;
    --callout-caution-color: #d06161;
  }

  /* typography */
  body {
    --main-font: ui-sans-serif, system-ui, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
    --code-font: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, 'Liberation Mono', 'Courier New', monospace;
    --homepage-max-width: 768px;
    --main-max-width: 768px;
    --avatar-size: 60px;
    --font-size: 16px;
    --line-height: 1.75;
    --img-border-radius: 0px;
    --detail-border-radius: 0px;
    --dark-mode-img-brightness: 0.75;
    --dark-mode-chart-brightness: 0.75;
    --inline-code-border-radius: 2px;
    --inline-code-bg-color: var(--primary-decoration-color);
    --block-code-border-radius: 0px;
    --block-code-border-color: var(--primary-color);
    --detail-border-color: var(--primary-color);
  }

  /* language switch */
  .lang-switch {
    display: inline-flex;
    align-items: center;
    flex-wrap: wrap;
    gap: 0.4rem;
    margin-top: 0.75rem;
    font-size: 0.85rem;
    color: var(--text-pale-color);
  }

  .lang-switch__label {
    font-weight: 600;
    text-transform: uppercase;
    letter-spacing: 0.03em;
    font-size: 0.75rem;
    color: var(--text-pale-color);
  }

  .lang-switch__current {
    padding: 0.15rem 0.55rem;
    border-radius: 999px;
    background: var(--primary-decoration-color);
    border: 1px solid transparent;
    color: var(--text-color);
    font-size: 0.8rem;
    letter-spacing: 0.01em;
  }

  .dark .lang-switch__current {
    background: rgba(255, 255, 255, 0.08);
    color: var(--text-color);
  }

  .lang-switch__link {
    padding: 0.15rem 0.55rem;
    border-radius: 999px;
    border: 1px solid var(--text-decoration-color);
    font-size: 0.8rem;
    color: var(--text-pale-color);
    text-decoration: none;
    transition: border 0.2s ease, color 0.2s ease, background 0.2s ease;
  }

  .lang-switch__link:hover,
  .lang-switch__link:focus-visible {
    border-color: var(--primary-color);
    color: var(--primary-color);
    background: var(--primary-pale-color);
    outline: none;
  }

  #post-info .lang-switch {
    margin-left: auto;
    margin-top: 0;
    gap: 0.3rem;
  }

  #post-info .lang-switch__label {
    display: none;
  }

  .homepage .lang-switch {
    margin-top: 1rem;
  }
</style>

  <link rel="stylesheet" href="https://psiace.me/main.css">
  

<link id="hl" rel="stylesheet" type="text/css" href="/hl-light.css" />



  
</head>

<body class="post">
  
  <script>
    const theme = sessionStorage.getItem('theme');
    const match = window.matchMedia("(prefers-color-scheme: dark)").matches
    if ((theme && theme == 'dark') || (!theme && match)) {
      document.body.classList.add('dark');
      const hl = document.querySelector('link#hl');
      if (hl) hl.href = 'https://psiace.me/hl-dark.css';
    }
  </script>
  
  





<div id="wrapper">
  <div id="blank"></div>
  <aside>
    
    
    <nav>
      <ul>
        
        <li>
          <a class="h2" href="#ce-shi-bing-bu-deng-jia-yu-fu-gai-lu">测试并不等价于覆盖率</a>
          
        </li>
        
        <li>
          <a class="h2" href="#ce-shi-shi-zai-dui-yu-yi-zuo-chang-qi-yue-shu">测试是在对语义做长期约束</a>
          
        </li>
        
        <li>
          <a class="h2" href="#ce-shi-shi-zai-xie-diao-wei-hu-zhe-pan-duan-yu-yong-hu-xian-shi">测试是在协调维护者判断与用户现实</a>
          
        </li>
        
        <li>
          <a class="h2" href="#ce-shi-zi-xin-rang-shuang-fang-dui-shi-bai-you-yi-zhi-li-jie">测试自信：让双方对“失败”有一致理解</a>
          
        </li>
        
        <li>
          <a class="h2" href="#jie-yu">结语</a>
          
        </li>
        
      </ul>
    </nav>
    
    
    <button id="back-to-top" aria-label="back to top">
      
      <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-arrow-up"><line x1="12" y1="19" x2="12" y2="5"></line><polyline points="5 12 12 5 19 12"></polyline></svg>

    </button>
    
  </aside>
  <main>
    

  



  

<header>
  <nav>
    <a id="back-link" href="https:&#x2F;&#x2F;psiace.me&#x2F;zh&#x2F;&#x2F;posts">← 返回</a>
  </nav>
</header>


    <div>
      
      
      
      
      <div id="copy-cfg" style="display: none;" data-copy-icon="&lt;svg xmlns=&quot;http:&#x2F;&#x2F;www.w3.org&#x2F;2000&#x2F;svg&quot; viewBox=&quot;0 0 24 24&quot; width=&quot;18&quot; height=&quot;18&quot;&gt;&lt;path d=&quot;M6.9998 6V3C6.9998 2.44772 7.44752 2 7.9998 2H19.9998C20.5521 2 20.9998 2.44772 20.9998 3V17C20.9998 17.5523 20.5521 18 19.9998 18H16.9998V20.9991C16.9998 21.5519 16.5499 22 15.993 22H4.00666C3.45059 22 3 21.5554 3 20.9991L3.0026 7.00087C3.0027 6.44811 3.45264 6 4.00942 6H6.9998ZM5.00242 8L5.00019 20H14.9998V8H5.00242ZM8.9998 6H16.9998V16H18.9998V4H8.9998V6Z&quot; fill=&quot;currentColor&quot;&gt;&lt;&#x2F;path&gt;&lt;&#x2F;svg&gt;
" data-check-icon="&lt;svg xmlns=&quot;http:&#x2F;&#x2F;www.w3.org&#x2F;2000&#x2F;svg&quot; viewBox=&quot;0 0 24 24&quot; width=&quot;18&quot; height=&quot;18&quot;&gt;&lt;path d=&quot;M10.0007 15.1709L19.1931 5.97852L20.6073 7.39273L10.0007 17.9993L3.63672 11.6354L5.05093 10.2212L10.0007 15.1709Z&quot; fill=&quot;currentColor&quot;&gt;&lt;&#x2F;path&gt;&lt;&#x2F;svg&gt;
"></div>
      
      <article class="prose">
        <h1>聊聊测试自信</h1>
        <div id="post-info">
          <div id="date">
            <span id="publish">Dec 25, 2025</span>
            </div>

          
          <div id="tags">
            <a class="instant" href="https://psiace.me/tags/engineering-confidence"><span>#</span>Engineering Confidence</a>
          </div>
          

          
          
          



  



  




  

  
    
    
    
      
    
    
    
  


  <div class="lang-switch" role="navigation" aria-label="语言">
    <span class="lang-switch__label">语言:</span>
    <span class="lang-switch__current">中文</span>
    <a class="lang-switch__link" href="https://psiace.me/posts/testing-confidence/">English</a> 
  </div>


        </div>

        
        

        

        <p>在长期构建可被他人依赖的软件系统的过程中，我逐渐意识到，测试并不是一个单纯的质量保证工具，而是一种在维护者与用户之间建立信任边界的工程手段。</p>
<p>当一个系统缺乏这种边界时，复杂度并不会消失，而是会转移到维护者的判断、用户的使用成本，或双方的协作摩擦中。</p>
<p>对维护者来说，测试决定了系统是否还能被持续演进。
对用户来说，测试决定了系统是否值得被依赖。</p>
<p>而所谓“测试自信”，并不是来自某个测试指标，而是来自这两种视角是否通过测试被清晰地对齐。</p>
<h2 id="ce-shi-bing-bu-deng-jia-yu-fu-gai-lu">测试并不等价于覆盖率<a class="zola-anchor" href="#ce-shi-bing-bu-deng-jia-yu-fu-gai-lu" aria-label="Anchor link for: ce-shi-bing-bu-deng-jia-yu-fu-gai-lu" style="visibility: hidden;"></a>
</h2>
<p>在工程实践中，测试常常被简化为一些指标：覆盖率、CI 通过率、回归数量。
这些指标对维护者而言确实有直接价值，它们降低了修改代码时的不确定性。</p>
<p>但这些指标本身，并不能回答用户真正关心的问题：</p>
<blockquote>
<p>当系统被放入真实环境、真实负载和真实依赖中，它的行为是否是可预期的？</p>
</blockquote>
<p>系统一旦被他人使用，其使用方式几乎一定会偏离设计者的预期。
测试的价值，并不在于穷举所有路径，而在于通过一组可执行的用例，把系统的预期行为和边界条件显式固定下来。</p>
<p>当这些边界是清晰的：</p>
<ul>
<li>维护者知道哪些行为不能被破坏。</li>
<li>用户知道哪些行为可以被依赖。</li>
</ul>
<p>从这个角度看，测试并不是代码的附属物，而是连接维护者与用户的一层结构。</p>
<h2 id="ce-shi-shi-zai-dui-yu-yi-zuo-chang-qi-yue-shu">测试是在对语义做长期约束<a class="zola-anchor" href="#ce-shi-shi-zai-dui-yu-yi-zuo-chang-qi-yue-shu" aria-label="Anchor link for: ce-shi-shi-zai-dui-yu-yi-zuo-chang-qi-yue-shu" style="visibility: hidden;"></a>
</h2>
<p>在 Databend 的实践中，我们大量依赖现有数据库系统中已经被验证过的测试用例，并对关键基准进行长期跟踪，以此来固定实现对既有语义和标准的承诺。</p>
<p>一个重要的事实是：
系统复杂度的主要来源，并不是实现难度，而是语义在时间维度上的稳定性。</p>
<p>例如：</p>
<ul>
<li>某些异常条件下应返回结果还是错误。</li>
<li>不同执行路径是否满足相同的不变量。</li>
<li>一些并不优雅、但被大量使用的行为是否需要长期兼容。</li>
</ul>
<p>如果这些语义没有通过测试被固定下来，对维护者而言，它们会变成一种隐性负担。
每一次修改，都需要依赖记忆和经验来判断“这会不会破坏什么”。</p>
<p>而对用户来说，语义漂移带来的风险更加直接。
同样的用法，在不同版本中可能产生不同结果。</p>
<p>因此，测试在这里承担的角色，并不是“检查代码有没有 bug”，而是：</p>
<ul>
<li>为维护者提供清晰的演进边界。</li>
<li>为用户提供稳定的行为预期。</li>
</ul>
<p>这也是为什么像 MySQL、SQLite 这样的系统，会长期将测试视为高价值资产——因为测试本身承载的是对用户的长期承诺。</p>
<h2 id="ce-shi-shi-zai-xie-diao-wei-hu-zhe-pan-duan-yu-yong-hu-xian-shi">测试是在协调维护者判断与用户现实<a class="zola-anchor" href="#ce-shi-shi-zai-xie-diao-wei-hu-zhe-pan-duan-yu-yong-hu-xian-shi" aria-label="Anchor link for: ce-shi-shi-zai-xie-diao-wei-hu-zhe-pan-duan-yu-yong-hu-xian-shi" style="visibility: hidden;"></a>
</h2>
<p>在 Apache OpenDAL 的 CI 中，囊括了数百种不同的测试，提供对多平台和不同服务、binding 下的全面测试。
事实上，单一贡献者很难有精力自主筹备完整测试环境所需的一切依赖和服务。</p>
<p>如果说 Databend 的测试主要解决的是系统内外部语义的稳定性，那么在 Apache OpenDAL，测试更多是在解决维护者判断与用户现实之间的落差。</p>
<p>在对象存储生态里，很多服务都会声称自己是“S3 compatible”。
对维护者来说，只要实现了规范，就很容易形成一种假设：
系统在工程上“应该是可用的”。</p>
<p>但用户并不会在规范层面使用系统，他们只会在真实账户、真实服务、真实失败模式中使用它。
而大量问题，正是在这种假设与现实的落差中出现的。</p>
<p>因此，在 OpenDAL 中，我们始终坚持：</p>
<ul>
<li>尽可能使用真实服务进行测试。</li>
<li>不把文档和兼容性声明当作工程事实。</li>
<li>将失败用例长期保留，作为回归测试的一部分。</li>
</ul>
<p>这类测试的价值在于：</p>
<ul>
<li>它约束了维护者对外部世界的过度乐观判断。</li>
<li>也为用户提供了一个明确的信号：
哪些行为是已经在现实环境中被验证过、可以依赖的。</li>
</ul>
<p>在这里，测试并不是为了“证明实现正确”，而是为了让维护者的判断与用户的现实使用保持一致。</p>
<h2 id="ce-shi-zi-xin-rang-shuang-fang-dui-shi-bai-you-yi-zhi-li-jie">测试自信：让双方对“失败”有一致理解<a class="zola-anchor" href="#ce-shi-zi-xin-rang-shuang-fang-dui-shi-bai-you-yi-zhi-li-jie" aria-label="Anchor link for: ce-shi-zi-xin-rang-shuang-fang-dui-shi-bai-you-yi-zhi-li-jie" style="visibility: hidden;"></a>
</h2>
<p>在这些实践中，我逐渐形成了一个比较稳定的判断：</p>
<blockquote>
<p>测试自信，并不是系统“很少出问题”，而是当问题出现时，维护者和用户对问题的性质有一致的理解。</p>
</blockquote>
<p>当某种行为被测试覆盖时：</p>
<ul>
<li>对用户而言，失败意味着 bug。</li>
<li>对维护者而言，修复是明确的工程责任。</li>
</ul>
<p>而当某种行为从未被测试：</p>
<ul>
<li>对用户而言，它就不应被视为系统承诺。</li>
<li>对维护者而言，也不应被默认为必须长期兼容的行为。</li>
</ul>
<p>测试让这种区分变得清晰、可执行、可回归，也显著降低了双方在预期上的摩擦成本。</p>
<h2 id="jie-yu">结语<a class="zola-anchor" href="#jie-yu" aria-label="Anchor link for: jie-yu" style="visibility: hidden;"></a>
</h2>
<p>从工程角度看，测试并不是只为维护者服务的工具，也不是只为用户提供保障的机制，而是让双方在同一套行为边界上达成共识的结构。</p>
<p>它把隐含假设变成显式约束，把个人经验变成可以延续的工程边界。</p>
<p>对我而言，无论系统处在哪一层，测试最终都服务于同一件事：</p>
<blockquote>
<p>让系统在被依赖时是可预期的，
让维护在长期演进中是可持续的。</p>
</blockquote>

      </article>

      
      

      
      
      <div class="giscus"></div>
      


  
    
  


  








  
    
    
  


<script
  src="https://giscus.app/client.js"
  data-repo="PsiACE/psiace"
  data-repo-id="R_kgDOKYGbpA"
  data-category="General"
  data-category-id="DIC_kwDOKYGbpM4CZxPW"
  data-mapping="specific"
  
    data-term="testing-confidence"
  
  data-strict="0"
  data-reactions-enabled="1"
  data-emit-metadata="0"
  data-input-position="top"
  data-theme="https://psiace.me/giscus_light.css"
  data-lang="zh-CN"
  data-loading="lazy"
  crossorigin="anonymous"
  async
></script>

      
    </div>

    


<footer>
  <div class="left">
    <div class="copyright">
      © 2025 Chojan Shang
      
      <span>|</span>
      Built with <a href="https://www.getzola.org" rel="noreferrer" target="_blank">zola</a> and <a href="https://github.com/isunjn/serene" rel="noreferrer" target="_blank">serene</a>
      
    </div>
  </div>

  <div class="right">
    
    
      
    
    
    <a id="rss-btn" href="https://psiace.me/posts/atom.xml">RSS</a>
    
    

    
    
    
    <button id="theme-toggle" aria-label="theme switch">
      <span class="moon-icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="18" height="18"><path d="M10 7C10 10.866 13.134 14 17 14C18.9584 14 20.729 13.1957 21.9995 11.8995C22 11.933 22 11.9665 22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12C2 6.47715 6.47715 2 12 2C12.0335 2 12.067 2 12.1005 2.00049C10.8043 3.27098 10 5.04157 10 7ZM4 12C4 16.4183 7.58172 20 12 20C15.0583 20 17.7158 18.2839 19.062 15.7621C18.3945 15.9187 17.7035 16 17 16C12.0294 16 8 11.9706 8 7C8 6.29648 8.08133 5.60547 8.2379 4.938C5.71611 6.28423 4 8.9417 4 12Z" fill="currentColor"></path></svg>
</span>
      <span class="sun-icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="18" height="18"><path d="M12 18C8.68629 18 6 15.3137 6 12C6 8.68629 8.68629 6 12 6C15.3137 6 18 8.68629 18 12C18 15.3137 15.3137 18 12 18ZM12 16C14.2091 16 16 14.2091 16 12C16 9.79086 14.2091 8 12 8C9.79086 8 8 9.79086 8 12C8 14.2091 9.79086 16 12 16ZM11 1H13V4H11V1ZM11 20H13V23H11V20ZM3.51472 4.92893L4.92893 3.51472L7.05025 5.63604L5.63604 7.05025L3.51472 4.92893ZM16.9497 18.364L18.364 16.9497L20.4853 19.0711L19.0711 20.4853L16.9497 18.364ZM19.0711 3.51472L20.4853 4.92893L18.364 7.05025L16.9497 5.63604L19.0711 3.51472ZM5.63604 16.9497L7.05025 18.364L4.92893 20.4853L3.51472 19.0711L5.63604 16.9497ZM23 11V13H20V11H23ZM4 11V13H1V11H4Z" fill="currentColor"></path></svg>
</span>
    </button>
    
  </div>
</footer>




<dialog id="rss-mask">
  <div>
    <a href="https:&#x2F;&#x2F;psiace.me&#x2F;posts&#x2F;atom.xml">https:&#x2F;&#x2F;psiace.me&#x2F;posts&#x2F;atom.xml</a>
    
    
    <button autofocus aria-label="copy" data-link="https:&#x2F;&#x2F;psiace.me&#x2F;posts&#x2F;atom.xml" data-copy-icon="&lt;svg xmlns=&quot;http:&#x2F;&#x2F;www.w3.org&#x2F;2000&#x2F;svg&quot; viewBox=&quot;0 0 24 24&quot; width=&quot;18&quot; height=&quot;18&quot;&gt;&lt;path d=&quot;M6.9998 6V3C6.9998 2.44772 7.44752 2 7.9998 2H19.9998C20.5521 2 20.9998 2.44772 20.9998 3V17C20.9998 17.5523 20.5521 18 19.9998 18H16.9998V20.9991C16.9998 21.5519 16.5499 22 15.993 22H4.00666C3.45059 22 3 21.5554 3 20.9991L3.0026 7.00087C3.0027 6.44811 3.45264 6 4.00942 6H6.9998ZM5.00242 8L5.00019 20H14.9998V8H5.00242ZM8.9998 6H16.9998V16H18.9998V4H8.9998V6Z&quot; fill=&quot;currentColor&quot;&gt;&lt;&#x2F;path&gt;&lt;&#x2F;svg&gt;
" data-check-icon="&lt;svg xmlns=&quot;http:&#x2F;&#x2F;www.w3.org&#x2F;2000&#x2F;svg&quot; viewBox=&quot;0 0 24 24&quot; width=&quot;18&quot; height=&quot;18&quot;&gt;&lt;path d=&quot;M10.0007 15.1709L19.1931 5.97852L20.6073 7.39273L10.0007 17.9993L3.63672 11.6354L5.05093 10.2212L10.0007 15.1709Z&quot; fill=&quot;currentColor&quot;&gt;&lt;&#x2F;path&gt;&lt;&#x2F;svg&gt;
" >
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="18" height="18"><path d="M6.9998 6V3C6.9998 2.44772 7.44752 2 7.9998 2H19.9998C20.5521 2 20.9998 2.44772 20.9998 3V17C20.9998 17.5523 20.5521 18 19.9998 18H16.9998V20.9991C16.9998 21.5519 16.5499 22 15.993 22H4.00666C3.45059 22 3 21.5554 3 20.9991L3.0026 7.00087C3.0027 6.44811 3.45264 6 4.00942 6H6.9998ZM5.00242 8L5.00019 20H14.9998V8H5.00242ZM8.9998 6H16.9998V16H18.9998V4H8.9998V6Z" fill="currentColor"></path></svg>

    </button>
  </div>
</dialog>



  </main>
</div>

  
<script src="/js/lightense.min.js"></script>


  <script src="https://psiace.me/js/main.js"></script>
</body>

</html>
