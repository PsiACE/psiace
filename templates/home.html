{% extends "serene/templates/home.html" %}

{% block content %}
{% set section_lang = section.extra.lang | default(value=section.lang) %}
<div id="wrapper">
  <main>
    <section id="info">
      {% if section.extra.avatar %}
      <img src="{{ get_url(path=section.extra.avatar) }}" alt="avatar">
      {% endif %}
      <div id="text">
        <div>
          <span id="name">{{ section.extra.name }}</span>
          {% if section.extra.id %}
          <span id="id">@{{ section.extra.id }}</span>
          {% endif %}
        </div>
        {% if section.extra.bio %}
        <div id="bio"> {{ section.extra.bio }} </div>
        {% endif %}
      </div>
    </section>
    {% set translations = section.translations %}
    {% set current_lang = section_lang %}
    {% include "_language_switch.html" %}
    <section id="links">
      <div id="left">
        {% for item in config.extra.sections %}
        {% set label = item.name %}
        {% if section_lang == "zh" %}
          {% if label == "posts" %}
            {% set label = "文章" %}
          {% elif label == "about" %}
            {% set label = "关于" %}
          {% endif %}
        {% endif %}
        <a {% if item.is_external %}href="{{ item.path }}" target="_blank" rel='noreferrer noopener'{% else %}href="{{ get_url(path=item.path) }}" class="instant"{% endif %}>{{ label }}</a>
        {% endfor %}
      </div>
      <div id="right">
        {% for link in section.extra.links %}
        <a href="{{ link.url }}" aria-label="{{ link.name }}" target="_blank" rel='noreferrer noopener'>
          {% set icon_path = "icon/" ~ link.icon ~ ".svg" %}
          {% set icon = load_data(path=icon_path) %}
          {{ icon | safe }}
        </a>
        {% endfor %}
        {% if not section.extra.footer and not config.extra.force_theme %}
        {% set moon_icon = load_data(path="icon/moon.svg") %}
        {% set sun_icon = load_data(path="icon/sun.svg") %}
        <button id="theme-toggle" aria-label="theme switch">
          <span class="moon-icon">{{ moon_icon | safe }}</span>
          <span class="sun-icon">{{ sun_icon | safe }}</span>
        </button>
        {% endif %}
      </div>
    </section>
    <section id="brief" class="prose">
      {{ section.content | trim | safe }}
    </section>
    {% if section.extra.recent %}
    {% set blog_section_path = config.extra.blog_section_path | trim_start_matches(pat="/") %}
    {% set section_md_path = blog_section_path ~ "/_index.md" %}
    {% set blog_section = get_section(path=section_md_path) %}
    <section class="layout-list">
      <div class="post-list">
        {% for post in blog_section.pages | slice(end=section.extra.recent_max) %}
        <a class="post instant {% if post.extra.featured %}featured{% endif %}" href="{{ post.permalink }}">
          <span>{{ post.title }}</span>
          <span class="line"></span>
          <span class="date">{{ post.date | date(format=section.extra.date_format) }}</span>
        </a>
        {% endfor %}
      </div>
      <div class="read-more">
        {% set more_text = section.extra.recent_more_text %}
        {% if section_lang == "zh" %}
          {% set more_text = "更多 »" %}
        {% endif %}
        <a class="instant" href="{{ config.extra.blog_section_path }}">{{ more_text }}</a>
      </div>
    </section>
    {% endif %}
  </main>
  {% if section.extra.footer %}
    {% include "_footer.html" %}
  {% endif %}
</div>
{% endblock content %}
